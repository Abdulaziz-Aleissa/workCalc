<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Work Time Calculator — Sun→Thu</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Cyber fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&family=Share+Tech+Mono&family=Audiowide&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg:#0f172a; --card:#111827; --muted:#94a3b8;
      --accent:#22c55e; --warn:#f59e0b; --error:#ef4444; --text:#e5e7eb;
      --select-bg:#0b1220; --select-text:#e5e7eb; --select-border:#444;
      
      --font:'Orbitron', sans-serif;
    }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--font);
      transition: background 0.3s, color 0.3s;
    }
    .card {
      background: var(--card);
      color: var(--text);
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
      transition: background 0.3s;
    }
    .card-header {
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .form-select {
      background: var(--select-bg);
      color: var(--select-text);
      border: 1px solid var(--select-border);
      
    }
    
    .pill {
      display:inline-block; padding:4px 10px; border-radius:999px;
      font-size:12px; border:1px solid rgba(148,163,184,0.2);
    }
    .good { color: var(--accent); border-color: rgba(34,197,94,0.4); }
    .warn { color: var(--warn); border-color: rgba(245,158,11,0.4); }
    .bad { color: var(--error); border-color: rgba(239,68,68,0.4); }
  </style>
</head>
<body>
  <div class="container py-4">
    <h1 class="mb-2 text-uppercase">Work Time Calculator (Sun → Thu)</h1>
    <p class=" mb-4">Each day = 8h, week = 40h. Enter either <strong>entry & leave times</strong> or a <strong>total duration</strong>. Extra/short minutes roll over automatically. <em>Data saved automatically.</em></p>
    
    <!-- Theme selector -->
    <div class="mb-4">
      <label for="themeSelect" class="form-label">Choose Theme:</label>
      <select id="themeSelect" class="form-select w-auto d-inline-block">
        <option value="cyberDark">Cyber Dark</option>
        <option value="neonBlue">Neon Blue</option>
        <option value="matrixGreen">Matrix Green</option>
        <option value="sunsetOrange">Sunset Orange</option>
        <option value="minimalLight">Minimal Light</option>
        <option value="redTheme">Red Theme</option>
        <option value="pinkTheme">Pink Theme</option>
      </select>
    </div>

 <!-- font selector -->
<div class="mb-4">
  <label for="fontSelect" class="form-label">Choose Font:</label>
  <select id="fontSelect" class="form-select w-auto d-inline-block">
    <option value="Orbitron">Orbitron</option>
    <option value="Share Tech Mono">Share Tech Mono</option>
    <option value="Audiowide">Audiowide</option>
    <option value="Roboto">Roboto</option>
    <option value="Courier New">Courier New</option>
    <option value="Comic Sans MS">Comic Sans</option>
  </select>
</div>





    <div id="cards" class="row g-3"></div>

    <div class="d-flex flex-wrap justify-content-between align-items-center mt-4">
      <div class="d-flex gap-2">
        <span id="totalWorked" class="pill"></span>
        <span id="weeklyStatus" class="pill"></span>
        <span id="todayPlan" class="pill"></span>
      </div>
      <button id="resetBtn" class="btn btn-outline-light btn-sm">Reset Week</button>
    </div>
  </div>  

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const days = ["Sunday","Monday","Tuesday","Wednesday","Thursday"];
  const TARGET_PER_DAY = 8*60;
  const WEEKLY_TARGET = 5*TARGET_PER_DAY;

  const STORAGE_KEY = 'workTimeCalculator';
  const THEME_KEY   = 'workTimeCalculatorTheme';
  const FONT_KEY    = 'workTimeCalculatorFont';

  const elCards = document.getElementById('cards');

  function buildSelect(idPrefix,label){
    return `
      <div class="mb-3">
        <label class="form-label">${label}</label>
        <div class="d-flex gap-2">
          <select id="${idPrefix}-hour" class="form-select">
            ${Array.from({length:24},(_,h)=>`<option value="${String(h).padStart(2,'0')}">${String(h).padStart(2,'0')}</option>`).join('')}
          </select>
          <select id="${idPrefix}-min" class="form-select">
            ${Array.from({length:60},(_,m)=>`<option value="${String(m).padStart(2,'0')}">${String(m).padStart(2,'0')}</option>`).join('')}
          </select>
        </div>
      </div>`;
  }

  days.forEach(d => {
    const id = d.toLowerCase();
    const col = document.createElement('div');
    col.className = 'col-sm-6';
    col.innerHTML = `
      <div class="card h-100">
        <div class="card-header">${d}</div>
        <div class="card-body">
          ${buildSelect(id+"-in","Entry")}
          ${buildSelect(id+"-out","Leave")}
          ${buildSelect(id+"-dur","Or total work (hh:mm)")}
          <div class="small" id="${id}-hint"></div>
        </div>
      </div>
    `;
    elCards.appendChild(col);
  });

  const selects = Array.from(document.querySelectorAll('select'));

  function loadData() {
    try {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) {
        const data = JSON.parse(saved);
        selects.forEach(sel => { if (data[sel.id]) sel.value = data[sel.id]; });
      }
    } catch (error) { console.log('Error loading saved data:', error); }
  }
  function saveData() {
    try {
      const data = {};
      selects.forEach(sel => { data[sel.id] = sel.value; });
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    } catch (error) { console.log('Error saving data:', error); }
  }
  function clearData() { localStorage.removeItem(STORAGE_KEY); }

  selects.forEach(sel => sel.addEventListener('change', () => { saveData(); recalc(); }));
  document.getElementById('resetBtn').addEventListener('click', () => {
    selects.forEach(s => s.selectedIndex=0);
    clearData(); recalc();
  });

  function toMin(hhmm){ if(!hhmm) return null; const [h,m]=hhmm.split(':').map(Number); return h*60+m; }
  function minToHM(mins){ const sign=mins<0?'-':''; const a=Math.abs(mins); return `${sign}${Math.floor(a/60)}h ${a%60}m`; }
  function addMinutes(hhmm,delta){ const m=toMin(hhmm); if(m==null)return null; let t=m+delta; const dayChange=Math.floor(t/(24*60)); t=((t%(24*60))+(24*60))%(24*60); return {time:`${String(Math.floor(t/60)).padStart(2,'0')}:${String(t%60).padStart(2,'0')}`,dayChange}; }
  function flexStart(hhmm){ if(!hhmm) return hhmm; const m = toMin(hhmm); const nine = 9*60, nineFifteen = 9*60 + 15; if (m >= nine && m <= nineFifteen) return "09:00"; return hhmm; }

  function getValue(prefix){
    const h=document.getElementById(prefix+"-hour").value;
    const m=document.getElementById(prefix+"-min").value;
    return `${h}:${m}`;
  }

  function getWorked(prefix){
    const dur=getValue(prefix+"-dur");
    if(dur!=="00:00"){ 
      return toMin(dur); 
    }
    const tin=getValue(prefix+"-in");
    const tout=getValue(prefix+"-out");
    if(tin!=="00:00" && tout!=="00:00"){
      const mi = toMin(flexStart(tin));
      const mo = toMin(tout);
      return mo >= mi ? mo - mi : (24*60 - mi + mo);
    }
    return null;
  }

  function recalc(){
    const worked=[];
    days.forEach(d=>{worked.push(getWorked(d.toLowerCase()));});
    days.forEach((d,idx)=>{
      const prefix=d.toLowerCase();
      const hint=document.getElementById(`${prefix}-hint`);
      const entry=getValue(prefix+"-in");
      const w=worked[idx];
      const plannedBefore=idx*TARGET_PER_DAY;
      const actualBefore=worked.slice(0,idx).reduce((a,b)=>a+(b||0),0);
      const balance=actualBefore-plannedBefore;
      let target=TARGET_PER_DAY-balance; if(target<0) target=0;

      if(w!=null){ 
        hint.innerHTML=`Worked <strong>${minToHM(w)}</strong>.`; 
      } else { 
        let msg=`You can work <strong>${minToHM(target)}</strong> today.`;
        if(entry!=="00:00"){
          const startForCalc = flexStart(entry);
          const res=addMinutes(startForCalc,target);
          if(res){
            const shownStart = (startForCalc !== entry) 
              ? `${entry} → <strong>${startForCalc}</strong>` 
              : `<strong>${entry}</strong>`;
            msg+=` If you start at ${shownStart}, leave by <strong>${res.time}</strong>${res.dayChange?` (+${res.dayChange}d)`:''}.`;
          }
        }
        hint.innerHTML=msg; 
      }
    });

    const total=worked.reduce((a,b)=>a+(b||0),0);
    const rem=WEEKLY_TARGET-total;
    const totalEl=document.getElementById('totalWorked');
    totalEl.textContent=`Total: ${minToHM(total)}`;

    const status=document.getElementById('weeklyStatus');
    if(rem>0){
      status.className='pill warn'; 
      status.textContent=`${minToHM(rem)} left`;
    } else if(rem===0){
      status.className='pill good'; 
      status.textContent='Target met';
    } else {
      status.className='pill good'; 
      status.textContent=`Over by ${minToHM(-rem)}`;
    }

        const nextIdx=worked.findIndex(v=>v==null);
    const plan=document.getElementById('todayPlan');
    if(nextIdx>=0){ 
      const plannedBefore=nextIdx*TARGET_PER_DAY; 
      const actualBefore=worked.slice(0,nextIdx).reduce((a,b)=>a+(b||0),0); 
      let t=TARGET_PER_DAY-(actualBefore-plannedBefore); 
      if(t<0) t=0; 
      plan.textContent=`${days[nextIdx]} plan: ${minToHM(t)}`; 
    } else { 
      plan.textContent='All days filled'; 
    }
  }

  // Theme definitions
  const themes = {
    cyberDark: { "--bg":"#0f172a","--card":"#111827","--text":"#e5e7eb","--accent":"#22c55e","--warn":"#f59e0b","--error":"#ef4444","--muted":"#94a3b8","--select-bg":"#0b1220","--select-text":"#e5e7eb","--select-border":"#444" },
    neonBlue: { "--bg":"#001f3f","--card":"#003366","--text":"#7FDBFF","--accent":"#39CCCC","--warn":"#FFDC00","--error":"#FF4136","--muted":"#AAAAAA","--select-bg":"#002244","--select-text":"#7FDBFF","--select-border":"#39CCCC" },
    matrixGreen: { "--bg":"#000","--card":"#001a00","--text":"#00FF00","--accent":"#00cc66","--warn":"#cccc00","--error":"#ff3333","--muted":"#339933","--select-bg":"#002200","--select-text":"#00FF00","--select-border":"#00cc66" },
    sunsetOrange: { "--bg":"#2c0a0a","--card":"#661111","--text":"#ffcc99","--accent":"#ff6600","--warn":"#ffcc00","--error":"#ff3300","--muted":"#ff9966","--select-bg":"#441111","--select-text":"#ffcc99","--select-border":"#ff6600" },
    minimalLight: { "--bg":"#f9f9f9","--card":"#ffffff","--text":"#222","--accent":"#2e8b57","--warn":"#cc8800","--error":"#cc0000","--muted":"#666","--select-bg":"#ffffff","--select-text":"#222","--select-border":"#ccc" },
    redTheme: { "--bg":"#100000","--card":"#780000","--text":"#ffcccc","--accent":"#ff0000","--warn":"#ff6600","--error":"#cc0000","--muted":"#ff9999","--select-bg":"#330000","--select-text":"#ffcccc","--select-border":"#ff0000" },
    pinkTheme: { "--bg":"#ffd6e7","--card":"#ffe6f0","--text":"#5a3d47","--accent":"#ff80ab","--warn":"#ffb3c6","--error":"#ff4d6d","--muted":"#c48fb3","--select-bg":"#ffe6f0","--select-text":"#5a3d47","--select-border":"#ff80ab" }
  };

  // Font selector
  const fontSelect = document.getElementById('fontSelect');
  fontSelect.addEventListener('change', e => {
    const chosenFont = e.target.value;
    document.documentElement.style.setProperty('--font', `'${chosenFont}', sans-serif`);
    localStorage.setItem(FONT_KEY, chosenFont);
  });

  // Theme selector
  const themeSelect = document.getElementById('themeSelect');
  themeSelect.addEventListener('change', e => {
    const themeName = e.target.value;
    const theme = themes[themeName];
    for(const key in theme){
      document.documentElement.style.setProperty(key, theme[key]);
    }
    localStorage.setItem(THEME_KEY, themeName);
  });

  // Load saved theme & font
  function loadPreferences(){
    const savedTheme = localStorage.getItem(THEME_KEY);
    if(savedTheme && themes[savedTheme]){
      themeSelect.value = savedTheme;
      const theme = themes[savedTheme];
      for(const key in theme){
        document.documentElement.style.setProperty(key, theme[key]);
      }
    }

    const savedFont = localStorage.getItem(FONT_KEY);
    if(savedFont){
      fontSelect.value = savedFont;
      document.documentElement.style.setProperty('--font', `'${savedFont}', sans-serif`);
    }
  }

  // Initialize
  loadData();
  loadPreferences();
  recalc();
</script>

</body>
</html>

